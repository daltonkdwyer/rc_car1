<html>
<!-- TEST COMMENT, PLEASE IGNORE -->
    <head>
        <title>Drive the car!</title>
        <link rel="stylesheet" href="css/main.css" />
    </head>

<body>
    <h1>Drive my car...</h1>

<!-- <button type="button" onclick="moveVehicle('FORWARD')">Move Forward</button>
<button type="button" onclick="moveVehicle('BACK')">Move Back</button>
<button type="button" onclick="moveVehicle('LEFT')">Move Left</button>
<button type="button" onclick="moveVehicle('RIGHT')">Move Right</button> -->

<script>
    const website = "http://127.0.0.1:5000/"
    // The direction comes in from each button
    function moveVehicle(direction) {
        var httpRequest = new XMLHttpRequest(),
        FD = new FormData();
        FD.append("direction", direction)
        // Shows where to send the data below (note that website is declared 6 lines above)
        httpRequest.open("POST", website, true);
        httpRequest.send(FD)
    }

    document.addEventListener('keydown', (event) => {
        // One of the below two functions prevents repeated POST requests from going through
        if (event.repeat) {
            console.log("PREVENT REPEAT???")
            return;
        }
        if (event.defaultPrevented) {
            return;
        };
        switch (event.key){
            case "ArrowUp":
                moveVehicle("FORWARD")
                break;
            case "ArrowDown":
                moveVehicle("BACK")
                break;
            case "ArrowLeft":
                moveVehicle("LEFT")
                break;
            case "ArrowRight":
                moveVehicle("RIGHT")
                break;
            case "Spacebar":
                moveVehicle("STOP")
                break;
            default:
                return;
        }

        event.preventDefault();
    }, true);

    window.addEventListener('keyup', function (event) {
        if (event.defaultPrevented) {
            return;
        };
        moveVehicle("STOP")

        event.preventDefault();
    }, true)

</script>
</body>

</html>